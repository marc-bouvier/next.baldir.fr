---
title: Ã€ la dÃ©couverte de Data.subvention
date: 2024-10-21T14:38:23+02:00
tags:
  - Candidature-en-public
  - Open-source
description: "DÃ©couvrons la startup d'Ã©tat â€œData.subventionâ€: sa mission, sa base de code. Embarquons-nous comme si câ€™Ã©tait notre premier jour."
draft: false
---

Je poursuis ma quÃªte pour travailler dans des organisations Ã  fort impact social.
Cet article est le compagnon du stream de [candidature en public](/glossaire/candidature-en-public)

## Contexte

> ### **ðŸŽ¯ La mission proposÃ©e**
>
> Tu participeras activement au dÃ©veloppement de la solution Data.Subvention agissant en Ã©quipe pour dÃ©velopper lâ€™API et le client web en suivant une mÃ©thodologie agile.Â 
>
> Les technologies utilisÃ©es sont :
>
> - TypeScript
> - Express
> - MongoDB
> - Svelte
> - Jest
>
> Le projet est gÃ©rÃ© viaÂ [GitHub](https://github.com/betagouv/api-subventions-asso/projects/1).
>
> Lâ€™Ã©quipe fonctionne en cycles courts rythmÃ©s par des rituels quotidiens. La gestion de lâ€™Ã©quipe se veut horizontale. ÃŠtre autonome sur les tÃ¢ches Ã  rÃ©aliser et sâ€™impliquer dans la conception du produit font partie de la mission.
>
> Tu pourras Ãªtre en contact avec dâ€™autres services techniques internes Ã  lâ€™Ã‰tat ainsi que des utilisateurs dans un but dâ€™amÃ©lioration continue de nos outils.
>
> Tous les membres de lâ€™Ã©quipe vivent dans des villes diffÃ©rentes et travaillent essentiellement Ã  distance. Tu auras la possibilitÃ© de te rendre sur le site de Beta.Gouv si tu le souhaites (Paris 7Ã¨me).
>
> Des sÃ©minaires rÃ©unissant toute lâ€™Ã©quipe sont organisÃ©s en prÃ©sentiel sur un format court (2 jours-2 nuits) tous les 4 mois environ.
>
> **ðŸ”Ž Le profil recherchÃ©**
>
> **Tu es :**
>
> - Capable de gÃ©rer un ensemble de tÃ¢ches en autonomie, en Ã©troite collaboration avec les autres membres de lâ€™Ã©quipe aux profils variÃ©s (data scientist, dÃ©veloppeurs, Ux Ui, Communication, ChargÃ©.e de dÃ©ploiement)
> - PrÃªt.e Ã  tâ€™impliquer dans la vie de la start-upÂ 
> - AnimÃ©Â·e par la volontÃ© dâ€™amÃ©liorer le service public
> - DotÃ© dâ€™une expÃ©rience dâ€™au moins 2 Ã  3 ans au sein de lâ€™Ã©cosystÃ¨me Beta.Gouv ou de lâ€™administration publique, dans un rÃ´le similaire
> - A lâ€™Ã©coute des autres et Ã  lâ€™aise dans la communication orale et Ã©crite
>
>
> **Tu maÃ®trises :**
>
> - JavaScript
> - MongoDB ou les bases de donnÃ©es en gÃ©nÃ©ral
> - Svelte ou un autre framework JS
> - Git et lâ€™Ã©cosystÃ¨me GitHub
> - Jest ou une autre librairie de tests
>
> **Câ€™est encore mieux si :**
>
> - Tu as des connaissances en architecture oignon (hexagonale/clean architecture)
> - Tu as de lâ€™appÃ©tence pour lâ€™open source et lâ€™open data
> - Tu es sensible Ã  la sÃ©curitÃ© des applications
> - Tu as lâ€™habitude de prendre en compte les retours utilisateurs
> ### **ðŸ“ Les modalitÃ©s**
>
> - Contrat : indÃ©pendant
> - TJM :Â  550â€‰â‚¬ (voir laÂ [grille de rÃ©munÃ©ration Beta Gouv](https://doc.incubateur.net/communaute/travailler-chez-beta.gouv.fr/les-differents-statuts/independants-freelances/observatoire-revenus#les-tjm-une-base-pour-evaluer-le-prix-dune-prestation))
> - Charge : 4 jours par semaine
> - DurÃ©e : 3 mois (renouvelable)
> - DÃ©but souhaitÃ© : dÃ©but Octobre 2024
> ### **ðŸš€ Candidater**
>
> Partage-nous ton LinkedIn / CV / Github / site par mail Ã Â [contact@datasubvention.beta.gouv.fr](https://doc.incubateur.net/communaute/travailler-chez-beta.gouv.fr/les-differents-statuts/independants-freelances/observatoire-revenus#les-tjm-une-base-pour-evaluer-le-prix-dune-prestation)Â avec en objet â€œRecrutement - DÃ©veloppement full-stack JavaScriptâ€ et raconte-nous :
>
> - Pourquoi le sujet des subventions aux associations te parle
> - Ce que tu penses pouvoir apporter au projet
> - Ce qui te plaÃ®t dans le travail en Ã©quipe et lâ€™agilitÃ©
>
> Ã€ bientÃ´t ! ðŸ˜€

Extrait de [la fiche de candidature sur Welcome to the Jungle au 08 octobre 2024](https://www.welcometothejungle.com/fr/companies/communaute-beta-gouv/jobs/developpeur-se-fullstack-javascript-de-la-start-up-d-etat-data-subvention?q=8a4078229b391e9f923f4012c12fdac5&o=7f2854cd-7b1d-4898-90c8-048206441a29)

## DÃ©couverte de la startup

Lecture de [la mission de la startup](https://beta.gouv.fr/startups/data-subvention.html).

Sans redire tout ce qui est dÃ©crit dans la fiche de la startup, voici l'essentiel de ce que j'ai retenu.

Data.subvention est une [startup dâ€™Ã©tat](/glossaire/startup-d-etat) qui a pour vocation :

- pour les instructeur-ices : de faciliter lâ€™instruction de dossiers de subvention pour des associations ;
- pour les associations : de faciliter les demandes de subvention ;

Data.subvention s'appuie sur des donnÃ©es provenant de diffÃ©rentes sources de donnÃ©es.

- Chorus : versements liÃ©s aux subventions
- Registre National des Associations: piÃ¨ces administratives des associations
- Le Compte Asso
- ...

Liste complÃ¨te : https://datasubvention.beta.gouv.fr/article-source-de-donnees-datasubvention/

Pour rÃ©soudre le problÃ¨me des instructeurs et des associations, data.subvention s'appuie sur la centralisation et l'aggrÃ©gation des donnÃ©es des sources variÃ©es.

### Points d'entrÃ©e

D'aprÃ¨s sa documentation d'API et [le guide d'intÃ©gration](https://github.com/betagouv/api-subventions-asso/wiki/Documentation-API-&-Guide-d'int%C3%A9gration), Data.subvention consiste en des points d'entrÃ©e destinÃ©s Ã  des [types de comptes diffÃ©rents](https://github.com/betagouv/api-subventions-asso/wiki/Documentation-API-&-Guide-d'int%C3%A9gration#les-comptes) : des comptes utilisateurs, des comptes consommateurs.

Les comptes utilisateur-ices : les agent-es, les instructeur-ices utilisent [l'outil de consultation](https://app.datasubvention.beta.gouv.fr/), iels se connectent Ã  l'aide de [AgentConnect](https://www.proconnect.gouv.fr/)

Les comptes consommateurs : les clients logiciel dans des systÃ¨mes qui veulent utiliser les donnÃ©es de [l'API](https://api-subvention-asso-prod.osc-secnum-fr1.scalingo.io/)

La fiche de la startup d'Ã©tat est cohÃ©rente avec l'offre de Welcome to the jungle :

Enjeux du moment :

- ComplÃ©tude : environ un tiers des donnÃ©es est disponible
    - DonnÃ©es des versements âœ…
    - DonnÃ©es des **collectivitÃ©s**
    - DonnÃ©es des **opÃ©rateurs**

Enjeux : **confiance** dans les donnÃ©es

Personas:

- Instructeurs âœ…
- Pilotes
- ContrÃ´leurs

## Dive in - rentrons dans le code

https://github.com/betagouv/api-subventions-asso

```sh
git clone git@github.com:betagouv/api-subventions-asso.git
```

Je note au fur et Ã  mesure ce que j'observe dans le code

| CapacitÃ©                           | Outil / pratique / version |
|------------------------------------|----------------------------|
| DÃ©ploiement                        | Scalingo                   |
| API doc                            | OpenApi 3.0                |
| ObservabilitÃ©                      | Sentry                     |
| Node                               | 18                         |
| Client REST                        | Axios                      |
| Monorepo                           | Lerna                      |
| Release                            | Conventional commit        |
| Pre-commit hook                    | Husky                      |
| VÃ©rification des mesages de commit | commitlint                 |
| CI-CD                              | Github Actions             |
| Framework frontend                 | Svelte                     |
| Design System                      | DSFR                       |
| Lib Design-System                  | @gouvfr/dsfr               |
| Svelte                             | 4.2                        |
| Test browser                       | Playwright                 |
| Events                             | SSE                        |

Intuition : Changelog trÃ¨s probablement construit avec conventional commit.

Github bots pour donner du feedback dans les PR. Covbot.

supertest ? (deja utilisÃ© dans nestjs)

Des tests automatisÃ©s avec Jest / vitest.

La documentation d'API semble gÃ©nÃ©rÃ©e depuis le code.

Route `/` quelques infos sur l'API:

- [Documentation API & Guide d'intÃ©gration](https://github.com/betagouv/api-subventions-asso/wiki/Documentation-API-&-Guide-d'int%C3%A9gration)

Dto : Types si on souhaite s'intÃ©grer avec Typescript

## Modules du monorepo

### Dto

- Commentaires en franÃ§ais et en anglais
- Noms en franglais
    - en franÃ§ais : les termes mÃ©tiers (ex. Association, Personne)
        - Pour la lisibilitÃ© de l'Open Data
    - en anglais ; les termes gÃ©nÃ©riques (ex. request, Search, Provider ...)

### Tools

Readme manque de contexte

Outils pour scrapper des donnÃ©es

- Osiris
- Annuaire service public

Je n'ai pas trouvÃ© de tests

### Frontend

Le frontend est une application Svelte.
Elle s'appuie sur l'API.

Observation : peu de dÃ©pendances.
SimplicitÃ©

Les noms de variable sont en anglais mÃªme si les termes mÃ©tier sont en franÃ§ais.

Je suis surpris de ce choix. Car il entraine une traduction qui ne me semble pas utile.
AprÃ¨s Ã§a reste un scope assez petit (quelques lignes). Ca ne devrait pas poser de problÃ¨me d'ambiguitÃ©.

Cela permet Ã  des gens non francophones de comprendre le code.

L'arborescence est documentÃ©e dans le readme : 

```text
src
â”‚
â””â”€â”€â”€lib                                      // Contient tous les composants Svelte mÃ©tier
â”‚    â”‚                                       
â”‚    â””â”€â”€â”€components                          // Contient tous les composants Svelte mÃ©tier
â”‚    â”‚   â”‚                                   
â”‚    â”‚   â”‚                                   
â”‚    â”‚   â””â”€â”€â”€Foo                             // Il existe autant de sous rÃ©pertoire que de composants "intelligent"
â”‚    â”‚       â”‚   Foo.svelte                  // Composant graphique Svelte (dumb)
â”‚    â”‚       â”‚   Foo.controller.js           // ContrÃ´leur qui s'occupe de rÃ©cupÃ©rer/calculer la donnÃ©e renvoyÃ©e au composant graphique
â”‚    â”‚       â”‚   ...                         
â”‚    â”‚                                       
â”‚    â””â”€â”€â”€core                                // Contient quelques fichiers "essentiels", comme le connecteur SSE
â”‚    â”‚                                       
â”‚    â””â”€â”€â”€dsfr                                // Contient tous les composants Svelte liÃ©s au composant du DSFR
â”‚    â”‚                                       
â”‚    â””â”€â”€â”€helpers                             // Contient des helpers spÃ©cifiques Ã  un champ particulier (string, date, etc)
â”‚    â”‚                                       
â”‚    â””â”€â”€â”€resources                           // Contient les connecteurs (ports) HTTP
â”‚    â”‚                                       
â”‚    â””â”€â”€â”€services                            // Contient des services mÃ©tiers qui ne sont pas liÃ©s Ã  un composant ou Ã  une ressource
â”‚    â”‚                                       
â”‚    â””â”€â”€â”€store                               // Contient une liste de stores globaux
â”‚                                            
â””â”€â”€â”€routes                                   
â”‚    â”‚                                       
â”‚    â””â”€â”€â”€example-route                       // nom de la route (voir routing)
â”‚    â”‚   â”‚                                   
â”‚    â”‚   â””â”€â”€â”€components                      // Contient des composants spÃ©cifiques Ã  la route en question. MÃªme architecture que pour les composants dans libs
â”‚    â”‚   â”‚                                   
â”‚    â”‚   â””â”€â”€â”€+page.ts                        // Il existe autant de sous rÃ©pertoire que de composants "intelligent"
â”‚    â”‚   â”‚                                   
â”‚    â”‚   â””â”€â”€â”€+page.svelte                    // Il existe autant de sous rÃ©pertoire que de composants "intelligent"
â”‚    â”‚   â”‚                                   
â”‚    â”‚   â””â”€â”€â”€+route.ts                       // Il existe autant de sous rÃ©pertoire que de composants "intelligent"
â”‚    â”‚                                       
â”‚    â””â”€â”€â”€...                                 // Autant de routes que nÃ©cessaire
â”‚    â”‚                                       
â”‚    â””â”€â”€â”€   +error.svelte                    // Page d'erreur (notamment 404)
â”‚    â”‚                                       
â”‚    â””â”€â”€â”€   +layout.svelte                   // Contient le layout gÃ©nÃ©ral (header, etc)
â”‚    â”‚                                       
â”‚    â””â”€â”€â”€   +layout.ts                       // Contient la logique qui doit s'appliquer pour toutes les pages
                                             
â”‚   main.js                                  // Point d'entrÃ©e de l'application
â”‚   global.css                               // Fichier CSS global
â”‚   app.html                                 // Coquille minimale autour des composants svelte
â”‚   hooks.server.ts                          // Hooks serveur. Permet notammer de spÃ©cifier les headers
```

L'arborescence telle que je l'observe aujourd'hui.

```text
src
â”œâ”€â”€ lib
â”‚Â Â  â”œâ”€â”€ assets
â”‚Â Â  â”œâ”€â”€ components                               
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ NomComposant                           
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ NomComposant.controller.test.ts   
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ NomComposant.controller.ts       
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ NomComposant.svelte                
â”‚Â Â  â”œâ”€â”€ core                                      
â”‚Â Â  â”œâ”€â”€ dsfr                                     
â”‚Â Â  â”œâ”€â”€ entities
â”‚Â Â  â”œâ”€â”€ enums
â”‚Â Â  â”œâ”€â”€ errors
â”‚Â Â  â”œâ”€â”€ helpers                                  
â”‚Â Â  â”œâ”€â”€ resources                                
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ associations
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ auth
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ document
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ establishments
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ externals
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ grants
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ open-source
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ payments
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ providers
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ stats
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ subventions
â”‚Â Â  â”‚Â Â  â””â”€â”€ users 
â”‚Â Â  â”œâ”€â”€ services                                
â”‚Â Â  â”œâ”€â”€ store
â”‚Â Â  â””â”€â”€ types
â”œâ”€â”€ routes
â”‚Â Â  â”œâ”€â”€ (home)
â”‚Â Â  â”œâ”€â”€ (noAuth)
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ accessibilite
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cgu
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ contact
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ mentions-legales
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ politique-de-confidentialite
â”‚Â Â  â”‚Â Â  â””â”€â”€ statistiques
â”‚Â Â  â”œâ”€â”€ admin
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ domains
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ stats
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ components
â”‚Â Â  â”‚Â Â  â””â”€â”€ users
â”‚Â Â  â”œâ”€â”€ association
â”‚Â Â  â”‚Â Â  â””â”€â”€ [identifier]
â”‚Â Â  â”œâ”€â”€ auth
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ activate
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ [token]
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ forget-password
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ login
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ reset-password
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ [token]
â”‚Â Â  â”‚Â Â  â””â”€â”€ signup
â”‚Â Â  â”œâ”€â”€ etablissement
â”‚Â Â  â”‚Â Â  â””â”€â”€ [identifier]
â”‚Â Â  â”œâ”€â”€ search
â”‚Â Â  â”‚Â Â  â””â”€â”€ [name]
â”‚Â Â  â””â”€â”€ user
â”‚Â Â      â””â”€â”€ profile
```

SÃ©paration des responsabilitÃ©s

Composants "intelligents" : vont chercher des donnÃ©es en s'appuyant sur des controllers

Les controlleurs font passe plat avec des API / Services

Tests

```sh
cd package/front
npm run test
```

```text
âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯ Unhandled Rejection âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯
Error: Sentry CLI "info" command failed, make sure you have an auth token configured, and your `url` option is correct.
 â¯ _callee2$ ../../node_modules/@sentry/bundler-plugin-core/dist/cjs/index.js:1334:19
 â¯ tryCatch ../../node_modules/@sentry/bundler-plugin-core/dist/cjs/index.js:134:17
 â¯ Generator._invoke ../../node_modules/@sentry/bundler-plugin-core/dist/cjs/index.js:114:24
 â¯ Generator.throw ../../node_modules/@sentry/bundler-plugin-core/dist/cjs/index.js:165:21
 â¯ asyncGeneratorStep ../../node_modules/@sentry/bundler-plugin-core/dist/cjs/index.js:398:24
 â¯ _throw ../../node_modules/@sentry/bundler-plugin-core/dist/cjs/index.js:424:9

```

> [!danger] Erreur lors du lancement des tests
> Lancer les tests front Ã©choue sans token sentry


Pour le moment je commente le plugin sentry vite pour voir les tests se lancer

`vite.config.ts`

```ts
import { fileURLToPath } from "url";  
import { readFileSync } from "fs";  
import { sentrySvelteKit } from "@sentry/sveltekit";  
import { sveltekit } from "@sveltejs/kit/vite";  
import { defineConfig, loadEnv } from "vite";  
  
const file = fileURLToPath(new URL("package.json", import.meta.url));  
const json = readFileSync(file, "utf8");  
const pkg = JSON.parse(json);  
  
export default defineConfig(({ mode }) => {  
    const env = loadEnv(mode, process.cwd(), "");  
    return {  
        plugins: [  
            // sentrySvelteKit({  
            //     sourceMapsUploadOptions: {            //         org: "betagouv",            //         project: "data-subvention-front",            //         url: "https://sentry.incubateur.net/",            //         authToken: env.SENTRY_AUTH_TOKEN || env.SENTRY_AUTH_TOKEN,            //         release: pkg.version            //     },            // }),            sveltekit(),  
        ],  
        test: {  
            include: ["src/**/*.{test,spec}.{js,ts}"],  
            globals: true,  
            environment: "jsdom",  
            clearMocks: true,  
            setupFiles: ["src/setuptest.ts"],  
        },  
        optimizeDeps: {  
            include: ["dto"],  
        },  
        build: {  
            commonjsOptions: {  
                include: [/dto/, /node_modules/],  
            },  
        },  
    };  
});
```

Le concept d'adapter semble Ãªtre ici une couched anticorruption : mapper

Le concept de Port semble Ãªtre un client d'API qui dÃ©lÃ¨gue Ã  un service REST en gÃ©nÃ©ral.

### API

Lors de la premiÃ¨re session de candidature en public, j'ai Ã  peine effleurÃ© l'API.
Je creuse un peu plus dans la deuxiÃ¨me session (vidÃ©o Ã  venir).

| CapacitÃ©             | Outil / pratique / version |
|----------------------|----------------------------|
| Mail                 | Brevo                      |
| ObservabilitÃ©        | Sentry                     |
| Client HTTP          | Axios                      |
| Base de donnÃ©e cache | MongoDb                    |
| Migrations           | MigrateMongo               |

Observation : On ne fait pas les migrations ArriÃ¨re dans mongo. Peut-Ãªtre que ce n'est pas grave tant que l'API n'est pas encore stabilisÃ©e ni trop utilisÃ©e par des consommateurs tiers.
Quand il y aura plus de consommateurs, pouvoir revenir en arriÃ¨re sur la donnÃ©e pourra avoir du sens.

Dbo : hypothÃ¨se : objet data pour mongo

## 2eme partie

La deuxiÃ¨me session de ma dÃ©couverte de la base de code de data.subvention.

## Exploration du site en production

Explorons le site https://datasubvention.beta.gouv.fr/ et regardons [la courte dÃ©mo](https://www.loom.com/share/2720a47a15ab4929bfb0ab2059ca3fe5?t=0).

Je suis impressionnÃ©, en 3 minutes, j'ai une idÃ©e assez claire de l'utilitÃ© du service et Ã  qui il est destinÃ©.

Cette dÃ©mon montre les capacitÃ©s que donne l'outil pour les catÃ©gories d'usager actuels : les instructeur-ices.

Les usagers Ã  venir (pilotes, contrÃ´leurs) ne sont propablement pas encore reprÃ©sentÃ©s dans cette dÃ©mo.

## Dashlord

Dashlord permet de grouper les mÃ©triques des services numÃ©riques des startups d'Ã©tat.

https://dashlord.incubateur.net/

## Ma comprÃ©hension de l'API

https://github.com/orgs/betagouv/projects/38/views/1?pane=issue&itemId=67150218&issue=betagouv%7Capi-subventions-asso%7C2459


> [!question] API : quelle est la diffÃ©rence entre les `Port` et les
`Repository` ?
> Il semble que les ports et les repositories puissent Ãªtre des MongoRepository. La diffÃ©rence entre les 2 ne semble pas Ãªtre technique mais plutÃ´t conceptuelle?
>

Batch ? RequÃªtes? ..

Interroger les services distants pour rÃ©cupÃ©rer un instantanÃ© des donnÃ©es.

Stocker dans mongo.

Mongo est un peu utilisÃ© comme un cache dÃ©jÃ  dÃ©normalisÃ© pour Ãªtre adaptÃ© Ã  l'API qu'on fournit.

J'aime bien le fait qu'il y ai des Readme dans le dossier de certains providers !

![Certains data providers ont leur propre fichier Readme qui apporte des subtilitÃ©s qu'il aurait Ã©tÃ© difficile de trouver en premier abord](/public/img/data-subvention-readme-interne-a-provider.png)
Mettre les informations dans le contexte : Living documentation

`modules/providers`

Chaque sous-dossier correspond Ã  un fournisseur de donnÃ©es.
Il peut Ãªtre interrogÃ© via son fichier `.service.ts`
Celui-ci abstrait la faÃ§on dont est rÃ©cupÃ©rÃ©e la donnÃ©e.
La donnÃ©e est persistÃ©e et dÃ©normalisÃ©e dans mongoDb.

`modules/repository.list.ts` : repositories/services mongodb

Les points d'entrÃ©e:

![Le dossier
`interfaces` prÃ©sente 4 sous-dossiers correspondant aux types de point dâ€™entrÃ©e de lâ€™API: cli, cron, http, sse ](/public/img/data-subvention-points-d-entree.png)

**Cli
** : ligne de commande, elle semble utilisÃ©e principalement pour synchroniser les donnÃ©es dans mongodb.

**Cron
** : tÃ¢ches planifiÃ©es Ã©galement pour resynchroniser des donnÃ©es tierces (ex. DÃ©marches simplifiÃ©es, Data bretagne)

**Http
** : API REST exposÃ©e, utilisÃ©e par les clients consommateurs (ex. le frontend : interface de consultation, consommateurs d'open-data).

**SSE
** : API en Server side events pour faire des requÃªtes qui peuvent prendre du temps (par exemple parcequ'elles aggrÃ¨gent plusieurs sources de donnÃ©es en live dont on ne peut pas forcÃ©ment connaitre le temps de rÃ©ponse Ã  l'avance). Elles sont faites en asynchrone et en parallÃ¨le. Le client va ouvrir un canal et Ã©couter les rÃ©sultats se construire sous forme de flux jusqu'Ã  ce que l'ensemble des donnÃ©es soit rÃ©cupÃ©rÃ©e.

## Lecture du Readme de l'API

Dans [le readme de l'API](https://github.com/betagouv/api-subventions-asso/blob/develop/packages/api/README.md), j'apprÃ©cie que des dÃ©finitions de ce qui est entendu sont rÃ©digÃ©es.
Il y a quelques Ã©lÃ©ments de contexte qui expliquent certains choix techniques et des pratiques.

J'aime en particulier le fait qu'une dÃ©finition des tests unitaires ait Ã©tÃ© apportÃ©e dans le contexte du produit. C'est souvent un concept dont la dÃ©finition varie d'une contexte Ã  l'autre et d'un individu Ã  l'autre. Le clarifier est vraiment utile Ã  mon sens.

Explication des variables d'environnement Ã  configurer.

Les principales conventions de code son expliquÃ©es et les workflow de travail (notamment avec Github)

## Questions mÃ©tier

- Comment va-t-on Ã©tendre l'usage pour les nouvelles catÃ©gories d'utilisateur-ices?
    - Pilotes
    - ContrÃ´leurs
- Comment l'Ã©quipe de la startupt va communiquer, binÃ´mer, immersion ?

## Questions techniques

Les questions qui me sont venues progressivement sur le plan technique.

Sur quel IAM registre s'appuie l'authentification ?

HypothÃ¨se : AgentConnect

config.domains : pour CORS?

code en anglais et termes mÃ©tier en franÃ§ais
Termes mÃ©tier en franÃ§ais traduits en en anglais dans les variables. Curieux d'en savoir un peu plus;
HypothÃ¨se : routes en franÃ§ais pour l'open-data

API : quelle est la diffÃ©rence entre les `Port` et les `Repository` ?

HypothÃ¨se :  Il semble que les ports et les repositories puissent Ãªtre des MongoRepository.

La diffÃ©rence entre les 2 ne semble pas Ãªtre technique mais plutÃ´t conceptuelle?

## 3 Ã¨me session

2024-10-20

Fork et configuration sur mon laptop

```sh
git clone git@github.com:marc-bouvier/fork-api-subventions-asso.git
```

Installation de la version de nodejs pin.

```sh
nvm install 18.17
```

Installation des dÃ©pendances

```sh
npm i
```

Arborescence globale

```sh
tree -d -I 'node_modules|packages/api/node_modules|packages/dto/node_modules|packages/front/node_modules|packages/tools/node_modules'
```

```text
.
â””â”€â”€ packages
    â”œâ”€â”€ api
    â”‚Â Â  â”œâ”€â”€ __mocks__
    â”‚Â Â  â”œâ”€â”€ assets
    â”‚Â Â  â”‚Â Â  â””â”€â”€ images
    â”‚Â Â  â”‚Â Â      â””â”€â”€ favicons
    â”‚Â Â  â”œâ”€â”€ migrations
    â”‚Â Â  â”œâ”€â”€ src
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @enums
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ authentication
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ configurations
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dataProviders
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ api
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dataBretagne
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ rechercheEntreprises
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ db
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ paymentFlat
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ rnaSiren
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ state-budget-program
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ uniteLegalEntreprise
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ uniteLegalImports
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ uniteLegalName
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ decorators
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ interfaces
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cli
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cron
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ http
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ sse
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ middlewares
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ modules
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ _open-data
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ grant
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ provider
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ admin-structure
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ association-name
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ associations
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ configurations
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ data-log
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ data-viz
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ paymentFlat
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ documents
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dump
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ etablissements
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ grant
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ index
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ notify
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ outPipes
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ payments
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ provider-request
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ dbo
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ providers
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __mocks__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ apiAsso
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ dto
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ apiEntreprise
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ avisSituationInsee
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ bodacc
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ dto
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ caisseDepots
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ dto
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ chorus
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dataBretagne
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ datagouv
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ historyUniteLegal
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ parser
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dauphin
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dto
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ dbo
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ demarchesSimplifiees
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dto
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ queries
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ schemas
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ fonjep
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ joiners
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ geoApi
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ gispro
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ leCompteAsso
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ osiris
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ dboAdapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ scdl
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dbo
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ subventia
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ validators
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ uniteLegalEntreprises
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ uniteLegalName
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ rna-siren
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ search
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ stats
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ joiners
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ migrations
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ subventions
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ user
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ repositories
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ dbo
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ errors
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ services
    â”‚Â Â  â”‚Â Â  â”‚Â Â          â”œâ”€â”€ activation
    â”‚Â Â  â”‚Â Â  â”‚Â Â          â”œâ”€â”€ agentConnect
    â”‚Â Â  â”‚Â Â  â”‚Â Â          â”œâ”€â”€ auth
    â”‚Â Â  â”‚Â Â  â”‚Â Â          â”œâ”€â”€ check
    â”‚Â Â  â”‚Â Â  â”‚Â Â          â”œâ”€â”€ consumer
    â”‚Â Â  â”‚Â Â  â”‚Â Â          â”œâ”€â”€ crud
    â”‚Â Â  â”‚Â Â  â”‚Â Â          â”œâ”€â”€ profile
    â”‚Â Â  â”‚Â Â  â”‚Â Â          â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â          â”œâ”€â”€ rgpd
    â”‚Â Â  â”‚Â Â  â”‚Â Â          â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â          â”œâ”€â”€ roles
    â”‚Â Â  â”‚Â Â  â”‚Â Â          â””â”€â”€ stats
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ shared
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ @types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __mocks__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ adapters
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ errors
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cliErrors
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dbError
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ httpErrors
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ NotFoundErrors
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ helpers
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â””â”€â”€ sse
    â”‚Â Â  â”‚Â Â      â””â”€â”€ @types
    â”‚Â Â  â”œâ”€â”€ tests
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __helpers__
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __mocks__
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ authentication
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ configurations
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dataProviders
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ api
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ db
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ interfaces
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cli
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cron
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ http
    â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â””â”€â”€ modules
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ providers
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ apiEntreprise
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ dauphin-gispro
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ fonjep
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ leCompteAsso
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ osiris
    â”‚Â Â  â”‚Â Â      â”‚Â Â      â””â”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â      â””â”€â”€ user
    â”‚Â Â  â”‚Â Â          â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â          â”œâ”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â          â””â”€â”€ repositories
    â”‚Â Â  â”‚Â Â              â””â”€â”€ __snapshots__
    â”‚Â Â  â””â”€â”€ tools
    â”‚Â Â      â”œâ”€â”€ datagouv
    â”‚Â Â      â”œâ”€â”€ fonjep
    â”‚Â Â      â”œâ”€â”€ helpers
    â”‚Â Â      â””â”€â”€ osiris
    â”œâ”€â”€ dto
    â”‚Â Â  â”œâ”€â”€ associations
    â”‚Â Â  â”œâ”€â”€ auth
    â”‚Â Â  â”‚Â Â  â””â”€â”€ subscriptionForm
    â”‚Â Â  â”œâ”€â”€ configurations
    â”‚Â Â  â”œâ”€â”€ consumer
    â”‚Â Â  â”œâ”€â”€ documents
    â”‚Â Â  â”œâ”€â”€ etablissements
    â”‚Â Â  â”œâ”€â”€ geoApi
    â”‚Â Â  â”œâ”€â”€ grant
    â”‚Â Â  â”œâ”€â”€ payments
    â”‚Â Â  â”œâ”€â”€ providers
    â”‚Â Â  â”œâ”€â”€ rna-siren
    â”‚Â Â  â”œâ”€â”€ search
    â”‚Â Â  â”œâ”€â”€ shared
    â”‚Â Â  â”œâ”€â”€ stats
    â”‚Â Â  â””â”€â”€ user
    â”œâ”€â”€ front
    â”‚Â Â  â”œâ”€â”€ src
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ lib
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ assets
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ images
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ components
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ AssociationCard
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Auth
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ AutocompleteSelect
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ DefinePassword
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Documents
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ components
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ EstablishmentPreview
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Header
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ InfosLegales
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ MainInfoBanner
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ MultiStepForm
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ SearchBar
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Stats
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ MonthlyGraph
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ MonthlyGraphTooltip
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ StructureFormStep
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ CentralSubStep
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ DecentralizedSubStep
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ OperatorSubStep
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ RegionField
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ TerritorialCollectivitySubStep
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ StructureTitle
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ SubventionsPaymentsDashboard
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Modals
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ PaymentTable
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ SubventionTable
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ StatutLabel
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ SubventionsPaymentsStatistique
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Tables
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ errors
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ core
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dsfr
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ enums
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ errors
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ helpers
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ resources
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ associations
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ entities
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ auth
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ subscriptionForm
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ document
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ establishments
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __fixtures__
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ types
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ externals
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ geo
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ grants
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ open-source
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ rna-siren
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ payments
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ providers
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ stats
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ subventions
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ users
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ services
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ store
    â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ types
    â”‚Â Â  â”‚Â Â  â””â”€â”€ routes
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ (home)
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ error
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ (noAuth)
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ accessibilite
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ cgu
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ contact
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ mentions-legales
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ politique-de-confidentialite
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ statistiques
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ admin
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ domains
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ stats
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ components
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â      â”œâ”€â”€ MonthlyRequestCountByYear
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â      â””â”€â”€ TopAssociations
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ users
    â”‚Â Â  â”‚Â Â      â”‚Â Â      â”œâ”€â”€ composents
    â”‚Â Â  â”‚Â Â      â”‚Â Â      â”‚Â Â  â”œâ”€â”€ MonthlyUserCountByYear
    â”‚Â Â  â”‚Â Â      â”‚Â Â      â”‚Â Â  â””â”€â”€ UserDistribution
    â”‚Â Â  â”‚Â Â      â”‚Â Â      â”œâ”€â”€ create
    â”‚Â Â  â”‚Â Â      â”‚Â Â      â”œâ”€â”€ list
    â”‚Â Â  â”‚Â Â      â”‚Â Â      â””â”€â”€ metrics
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ association
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ [identifier]
    â”‚Â Â  â”‚Â Â      â”‚Â Â      â””â”€â”€ components
    â”‚Â Â  â”‚Â Â      â”‚Â Â          â”œâ”€â”€ Bodacc
    â”‚Â Â  â”‚Â Â      â”‚Â Â          â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â      â”‚Â Â          â”œâ”€â”€ Establishments
    â”‚Â Â  â”‚Â Â      â”‚Â Â          â””â”€â”€ Stats
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ auth
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ activate
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ [token]
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â      â”œâ”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â      â””â”€â”€ components
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â          â””â”€â”€ AgentTypeStep
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â              â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ forget-password
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ login
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ reset-password
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ [token]
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ signup
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ etablissement
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ [identifier]
    â”‚Â Â  â”‚Â Â      â”‚Â Â      â””â”€â”€ components
    â”‚Â Â  â”‚Â Â      â”‚Â Â          â”œâ”€â”€ ContactEtab
    â”‚Â Â  â”‚Â Â      â”‚Â Â          â”‚Â Â  â””â”€â”€ __snapshots__
    â”‚Â Â  â”‚Â Â      â”‚Â Â          â””â”€â”€ InfosBancairesEtab
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ search
    â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ [name]
    â”‚Â Â  â”‚Â Â      â””â”€â”€ user
    â”‚Â Â  â”‚Â Â          â””â”€â”€ profile
    â”‚Â Â  â”‚Â Â              â””â”€â”€ components
    â”‚Â Â  â”‚Â Â                  â””â”€â”€ ResetPwdModule
    â”‚Â Â  â”œâ”€â”€ static
    â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dsfr
    â”‚Â Â  â”‚Â Â  â””â”€â”€ files
    â”‚Â Â  â””â”€â”€ tests
    â””â”€â”€ tools
        â”œâ”€â”€ osiris-automation
        â”‚Â Â  â”œâ”€â”€ Osiris
        â”‚Â Â  â”œâ”€â”€ OsirisPuppeteer
        â”‚Â Â  â””â”€â”€ cleaned_modules
        â”‚Â Â      â””â”€â”€ signalR
        â””â”€â”€ scrapping-lannuaire-service-public

422 directories
```

DÃ©sactiver Sentry pour lancer les tests.

`packages/front/vite.config.ts`

```ts
import {sveltekit} from "@sveltejs/kit/vite";
import {defineConfig, loadEnv} from "vite";

const file = fileURLToPath(new URL("package.json", import.meta.url));
const json = readFileSync(file, "utf8");
const pkg = JSON.parse(json);

export default defineConfig(({mode}) => {
    const env = loadEnv(mode, process.cwd(), "");
    return {
        plugins: [
            //    sentrySvelteKit({
            //        sourceMapsUploadOptions: {
            //            org: "betagouv",
            //            project: "data-subvention-front",
            //            url: "https://sentry.incubateur.net/",
            //            authToken: env.SENTRY_AUTH_TOKEN || env.SENTRY_AUTH_TOKEN,
            //            release: pkg.version
            //        },
            //    }),
            sveltekit(),
        ],
        test: {
            include: ["src/**/*.{test,spec}.{js,ts}"],
            globals: true,
            environment: "jsdom",
            clearMocks: true,
            setupFiles: ["src/setuptest.ts"],
        },
        optimizeDeps: {
            include: ["dto"],
        },
        build: {
            commonjsOptions: {
                include: [/dto/, /node_modules/],
            },
        },
    };
});

```

Build le projet

```sh
npm run build
```

> [!sucess]
> ```text
> 
> api-subventions-asso@0.10.3 build
> lerna run build
> 
> lerna notice cli v8.1.3
> 
>    âœ”  dto:build (3s)
>    âœ”  api:build (8s)
>    âœ”  front:build (11s)
> 
> â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
> 
>  Lerna (powered by Nx)   Successfully ran target build for 3 projects (14s)
> ```

Lancement des tests pour voir.

```sh
npm test
```

> [!success]
> ```text
> api-subventions-asso@0.10.3 test
> lerna run test
> 
> lerna notice cli v8.1.3
> 
>    âœ”  dto:test (346ms)
>    âœ”  tools:test (347ms)
>    âœ”  front:test (10s)
>    âœ”  api:test (2m)
> 
> â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
> 
>  Lerna (powered by Nx)   Successfully ran target test for 4 projects (2m)
> ```


Configuration des variables d'environnement de l'API.

Comme indiquÃ© dans le readme de l'API.

CrÃ©ation d'un fichier `.env` Ã  la racine du projet.
Pour le moment je tente de le mettre Ã  vide

```sh
# Required variables
# ------------------------------

# 
JWT_SECRET=
MAIL_HOST=
MAIL_PORT=
MAIL_USER=
MAIL_PASSWORD=

# Other variables
# ------------------------------

# To connect to association API
#API_ASSO_URL=
#API_ASSO_TOKEN=

# To specify a database name
#MONGO_DBNAME=datasubvention

# To connect to Entreprise API
#API_ENTREPRISE_TOKEN=

# To use Brevo e-mail services
#API_SENDINBLUE_TOKEN=
#API_SENDINBLUE_CONTACT_LIST=

# To connect ot DAUPHIN
#DAUPHIN_USERNAME=
#DAUPHIN_PASSWORD=

# To use Sentry bug reporting
#SENTRY_AUTH_TOKEN=

```

````md
## Setup

Pour utiliser l'api, vous devez au prÃ©alable avoir installÃ© Node.js et NPM.

Vous devez ensuite installer les dÃ©pendances avec `npm install`.

Ensuite, il vous faudra crÃ©er un fichier .env Ã  la racine du projet, avec au moins les variables d'environnement suivantes:

- JWT_SECRET
- MAIL_HOST
- MAIL_PORT
- MAIL_USER
- MAIL_PASSWORD

Les autres variables utilisÃ©es sont :

- API_ASSO_URL
- API_ASSO_TOKEN

Pour se connecter Ã  l'API Association

- MONGO_DBNAME=datasubvention

Pour spÃ©cifier le nom de la base de donnÃ©e

- API_ENTREPRISE_TOKEN

Pour se connecter Ã  l'API Entreprise

- API_SENDINBLUE_TOKEN
- API_SENDINBLUE_CONTACT_LIST

Pour utiliser les services Brevo (envoi de mail)

- DAUPHIN_USERNAME
- DAUPHIN_PASSWORD

Pour se connecter Ã  DAUPHIN

- SENTRY_AUTH_TOKEN

Pour utiliser le reporting de bug Sentry

Pour fonctionner l'api doit pouvoir se connecter Ã  une base de donnÃ©es mongoDB v4.0 .  
Par dÃ©faut, elle se connecte Ã  l'url
`mongodb://localhost:27017/api-subventions-asso`.  
Il est possible de paramÃ©trer ces informations dans le fichier .env. Le nom des variables se trouve dans
`configurations/mongo.conf.ts`.

Vous pouvez utiliser docker pour simplifier l'installation de MongoDB avec les commandes suivantes :  
`sudo docker pull mongo:4.0.3`  
`sudo docker run -d -p 27017:27017 mongo`
````

LanÃ§ons en mode dev pour voir :

```sh
npm run dev
```

Ooupsie, j'ai oubliÃ© de mettre une base de donnÃ©es mongodb.

Je vais crÃ©er un docker-compose pour mongo.

Je vais suivre le guide officiel :

https://www.mongodb.com/resources/products/compatibilities/docker

Un fichier `docker-compose.yml` minimaliste.

Note : j'ai changÃ© le port exposÃ© (
`27117:25017`) pour Ã©viter des conflits avec d'autres projets.

```yml
services:
  mongodb:
    image: mongo:4.0.3
    environment:
    ports:
      - '27117:27017'
```

```sh
docker compose up -d
```

Quelques modifications pour faire fonctionner la base de donnÃ©es :

`.env`

```sh
# Required variables  
# ------------------------------  
  
JWT_SECRET=xxxxxxxxxxxxxxxx 
MAIL_HOST=  
MAIL_PORT=  
MAIL_USER=  
MAIL_PASSWORD=  
  
  
# Other variables  
# ------------------------------  
  
# To connect to association API  
#API_ASSO_URL=  
#API_ASSO_TOKEN=  
  
# To specify a database name  
MONGO_DBNAME=datasubvention  
#MONGO_USER=user  
#MONGO_PASSWORD=pass  
MONGO_PORT=27117  
  
FRONT_OFFICE_URL=http://localhost:5173  
  
# To connect to Entreprise API  
#API_ENTREPRISE_TOKEN=  
  
# To use Brevo e-mail services  
#API_SENDINBLUE_TOKEN=  
#API_SENDINBLUE_CONTACT_LIST=  
  
# To connect ot DAUPHIN  
#DAUPHIN_USERNAME=  
#DAUPHIN_PASSWORD=  
  
# To use Sentry bug reporting  
#SENTRY_AUTH_TOKEN=
```

Il semble qu'il faille que le JWT_SECRET soit renseignÃ©, comme prÃ©vu.

```text
[0] /Users/marco/sources/Baldir/Candidatures/beta-gouv/dinum/fork-api-subventions-asso/node_modules/passport-jwt/lib/strategy.js:45
[0]         throw new TypeError('JwtStrategy requires a secret or key');
[0]               ^
[0] TypeError: JwtStrategy requires a secret or key
[0]     at new JwtStrategy (/Users/marco/sources/Baldir/Candidatures/beta-gouv/dinum/fork-api-subventions-asso/node_modules/passport-jwt/lib/strategy.js:45:15)
[0]     at registerAuthMiddlewares (/Users/marco/sources/Baldir/Candidatures/beta-gouv/dinum/fork-api-subventions-asso/packages/api/src/authentication/express.auth.hooks.ts:49:9)
[0]     at startServer (/Users/marco/sources/Baldir/Candidatures/beta-gouv/dinum/fork-api-subventions-asso/packages/api/src/server.ts:78:34)
[0]     at main (/Users/marco/sources/Baldir/Candidatures/beta-gouv/dinum/fork-api-subventions-asso/packages/api/src/index.ts:13:22)
[0]     at processTicksAndRejections (node:internal/process/task_queues:105:5)
[0] [nodemon] app crashed - waiting for file changes before starting...


```

J'en gÃ©nÃ¨re un au pif avec https://jwtsecret.com/generate

Et je relance

```sh
npm run dev
```

- Frontend : http://localhost:5173/
- API :  http://localhost:8080

Le site se lance !

![data.subventions dans un navigateur en local](/public/img/data-subvention-localhost.png)

Il faut maintenant que je me connecte.

Je vais voir s'il existe un moyen de se connecter quand on travaille en local.

Dans `packages/api/README.md`

````md


### Pour AgentConnect

AgentConnect ne fonctionne pas avec l'url
`localhost`. Pour qu'AgentConnect fonctionne, il faut

1. dÃ©finir les variables d'environnements
    - AGENT_CONNECT_ENABLED -> `true`
    - AGENT_CONNECT_CLIENT_ID
    - AGENT_CONNECT_CLIENT_SECRET
    - AGENT_CONNECT_URL : https://fca.integ01.dev-agentconnect.fr/api/v2 en local et prÃ©prod
2. mettre en place un alias qui redirige `dev.local` vers
   `localhost`. Pour cela, ajouter au fichier `/etc/hosts` la ligne
    ```  
    127.0.0.1 dev.local  
    ```    Dans l'absolu il faut que l'alias corresponde Ã  ce qui a Ã©tÃ© renseignÃ© lors de la demande des client_id et client_secret utilisÃ©s.


````

Par dÃ©faut, AgentConnect ne semble pas activÃ©.

https://github.com/marc-bouvier/fork-api-subventions-asso/blob/89c3f61f3edc8509bb2c46a8b7a9cfdfe4bbd2d5/packages/api/src/configurations/agentConnect.conf.ts

Voyons si je peux crÃ©er un compte utilisateur localement.

![](/public/img/data-subvention-creer-compte.png)

![](/public/img/data-subvention-signup-error.png)

![](/public/img/data-subvention-localhost-cors-error.png)

CrÃ©er un utilisateur

Dans `packages/api`

```sh
export JWT_SECRET=...
export MONGO_PORT=27117
```

```sh
npm run cli user create baldir.fr@gmail.com
 ```

RequÃªte HTTP dans le client HTTP de Webstorm

```text
POST http://localhost:8080/auth/forget-password  
Content-Type: application/json  
  
{  
  "email": "baldir.fr@gmail.com"  
}
```

Token  : 21ZCxnFqUoBvlpGch7cBVNRHPL579iE6

```text
  
POST http://localhost:8080/auth/reset-password  
Content-Type: application/json  
  
{  
  "password": "P@ssw0rd",  
  "token": "21ZCxnFqUoBvlpGch7cBVNRHPL579iE6"  
}

```

![](/public/img/data-subvention-index-page.png)

I'm in !

Ajout du rÃ´le `admin` Ã  mon utilisateur :

![](/public/img/data-subvention-add-role-admin-mongo.png)

## Sidetracks

Comment faire que la bonne version de nodejs s'installe et switch auto quand je suis dans le dossier ?


## Alimenter avec quelques exemples de donnÃ©es


DonnÃ©es fonjep depuis des fixtures de test

Depuis `packages/api`
```sh
npm run cli fonjep parse "tests/modules/providers/fonjep/__fixtures__/fonjep-new.xlsx" 2024-10-21T19:53:15+02:00
```

